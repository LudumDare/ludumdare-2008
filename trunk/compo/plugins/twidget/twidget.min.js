function GetTwitchTVPlayer(t,e,a,i,c){var s="";return s+='<object type="application/x-shockwave-flash" height="',s+=a,s+='" width="',s+=e,s+='" id="live_embed_player_flash" data="http://www.twitch.tv/widgets/live_embed_player.swf?channel=',s+=t,s+='" bgcolor="#000000"><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="all" /><param name="movie" value="http://www.twitch.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.twitch.tv&channel=',s+=t,s+="&auto_play=",s+=i,s+="&start_volume=",s+=c,s+='" /></object>'}function ShowTwitchTVVideo(t){var e=TwitchTV_Streams,a="";if(TwitchTV_CurrentStream>=0&&e.length>TwitchTV_CurrentStream){var i=e[TwitchTV_CurrentStream];a+=GetTwitchTVPlayer(i.channel.name,282,188,t,25)}else a+='<div style="vertical-align:middle;display:table-cell;width:282px;height:188px;">',a+='<span class="Intense">Live Streaming Video!</span><br />',a+="Click on a video to start playing<br />",a+="<br />",a+='<span style="font-size:20px;">To stream here, set your<br />',a+='<object data="'+TwitchTV_BaseDir+'TwitchLogo.svg" height="30" style="vertical-align:middle;display:inline-block;" type="image/svg+xml"></object> game to <span class="Standout">'+TwitchTV_Game+"</span>",a+="</span>",a+="</div>";var c=$("#TTV_Video");c.html(a)}function OnTwitchTVStopProp(t){t.stopPropagation()}function OnTwitchTVClicked(t){var e=TwitchTV_Streams;if(TwitchTV_CurrentStream>=0&&e.length>TwitchTV_CurrentStream){var a=$("#TTV_ItemId_"+TwitchTV_CurrentStream);a.removeClass("ItemSelected"),a.addClass("Item")}if(null!=t){var i=+t.replace("TTV_ItemId_",""),c=$("#"+t);i>=0&&e.length>i&&(c.removeClass("Item"),c.addClass("ItemSelected")),TwitchTV_CurrentStream=i,ShowTwitchTVVideo(!0)}else TwitchTV_CurrentStream=-1,ShowTwitchTVVideo(!1)}function GetTwitchTVStreams(){for(var t=TwitchTV_Streams,e="",a=0;t.length>a;a++){var i=t[a],c=i.channel.display_name.replace(RegExp("_","g")," "),s=i.viewers;e+=a==TwitchTV_CurrentStream?"<div class='ItemSelected' onclick='OnTwitchTVClicked(this.id)' id='TTV_ItemId_"+a+"'>":"<div class='Item' onclick='OnTwitchTVClicked(this.id)' id='TTV_ItemId_"+a+"'>",e+='<img class="Item_Image" src="'+i.preview.small+'" width="80" height="50" />',e+='<span class="Item_Body">',e+='<span class="Item_Name">'+c+"</span><br />",e+='<span class="Item_Viewers">Viewers: <b>'+s+"</b></span>",e+='<span class="Item_Link"><a href="'+i.channel.url+'" target="_blank" onclick="OnTwitchTVStopProp(event)">( ... )</a></span>',e+="</span>",e+="</div>"}return TwitchTV_HasMoreStreams&&(e+='<div class="ItemMore">',e+='<div class="ItemMore_Body" onclick="LoadTwitchTVStreamsButton()">',e+='<div class="ItemMore_ButtonLeft"></div>',e+='<div id="TTV_More" class="ItemMore_Button">',e+='<div class="ItemMore_Text">More</div>',e+="</div>",e+='<div class="ItemMore_ButtonRight"></div>',e+="</div>",e+="</div>"),e}function LoadTwitchTVStreams(){Twitch.api({method:"streams",params:{game:TwitchTV_Game,limit:TwitchTV_Limit,offset:TwitchTV_Streams.length}},function(t,e){var a="";t?a+="Stream Fetch "+t+".<br />":(e.streams.length!=TwitchTV_Limit&&(TwitchTV_HasMoreStreams=!1),TwitchTV_Streams=TwitchTV_Streams.concat(e.streams),a+=GetTwitchTVStreams(),TwitchTV_VideoActive||(ShowTwitchTVVideo(!1),TwitchTV_VideoActive=!0));var i=$("#TTV_Streams");i.html(a)})}function LoadTwitchTVStreamsButton(){$("#TTV_More").html('<span class="ItemMore_Button">...</span>'),LoadTwitchTVStreams()}function SetTwitchStandbyButton(){$("#TTV_Standby_Container").html('<object id="TTV_Standby" data="'+TwitchTV_BaseDir+'ImgStandby.svg" width="22" height="22" type="image/svg+xml"></object>');var t=document.getElementById("TTV_Standby");t.addEventListener("load",function(){try{var e=t.contentDocument,a=e.getElementById("TTV_Standby_Icon");a.addEventListener("click",function(){OnTwitchTVClicked(null)},!1)}catch(i){console.log("Unable to bind function to Standby")}},!1)}function InitTwitchTV(){Twitch.init({clientId:TwitchTV_APIKey},function(t){t?MyText+="Twitch API "+t+".<br />":(SetTwitchStandbyButton(),LoadTwitchTVStreams())})}function GetTwitchTVWidget(){var t="",e="&nbsp;&nbsp;&nbsp;&nbsp;";return t+='<div id="TTV">',t+='<div class="Widget">',t+='<div id="TTV_Video" class="Head"></div>',t+='<div id="TTV_Streams" class="Body">Loading...</div>',t+='<div class="FarEdge"></div>',t+="</div>",t+='<div class="Foot">',t+='<div class="FootBody">',t+='<span class="FootImg">',t+='<object data="'+TwitchTV_BaseDir+'ImgTwitchGlitch.svg" width="24" height="24" type="image/svg+xml"></object>',t+="</span>",t+="&nbsp;&nbsp;",t+='<span class="FootText">',t+='<a href="http://www.twitch.tv/directory/game/'+encodeURI(TwitchTV_Game)+'" target="_blank"> View All Streams</a>',t+="</span>",t+=e,t+='<span class="FootText">',t+='<a href="'+TwitchTV_FAQ+'">FAQ</a>',t+="</span>",t+='<span id="TTV_Standby_Container" class="FootImg2">',t+='<object id="TTV_Standby" data="'+TwitchTV_BaseDir+'ImgStandby.svg" width="22" height="22" type="image/svg+xml"></object>',t+="</span>",t+="</div>",t+='<div class="FootEdge"></div>',t+="</div>",t+="</div>"}var TwitchTV_Limit=4,TwitchTV_CurrentStream=-1,TwitchTV_VideoActive=!1,TwitchTV_HasMoreStreams=!0,TwitchTV_Streams=[];