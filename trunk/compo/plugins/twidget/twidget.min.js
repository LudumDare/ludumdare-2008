function GetTwitchTVPlayer(t,e,a,i,s){var c="";return c+='<object type="application/x-shockwave-flash" height="',c+=a,c+='" width="',c+=e,c+='" id="live_embed_player_flash" data="http://www.twitch.tv/widgets/live_embed_player.swf?channel=',c+=t,c+='" bgcolor="#000000"><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="all" /><param name="movie" value="http://www.twitch.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.twitch.tv&channel=',c+=t,c+="&auto_play=",c+=i,c+="&start_volume=",c+=s,c+='" /></object>'}function ShowTwitchTVVideo(t){var e=TwitchTV_Streams,a="";if(TwitchTV_CurrentStream>=0&&e.length>TwitchTV_CurrentStream){var i=e[TwitchTV_CurrentStream];a+=GetTwitchTVPlayer(i.channel.name,282,188,t,25)}else a+='<div style="vertical-align:middle;display:table-cell;width:282px;height:188px;"><span class="Intense">Live Streaming Video!</span><br />Click on a video to start playing<br /><br /><span style="font-size:20px;">To stream here, set your<br /><img src="'+TwitchTV_BaseDir+'TwitchLogo.svg" height="30" style="vertical-align:middle;" /> game to <span class="Standout">'+TwitchTV_Game+"</span></span></div>";var s=$("#TTV_Video");s.html(a)}function OnTwitchTVStopProp(t){t.stopPropagation()}function OnTwitchTVClicked(t){var e=TwitchTV_Streams;if(TwitchTV_CurrentStream>=0&&e.length>TwitchTV_CurrentStream){var a=$("#TTV_ItemId_"+TwitchTV_CurrentStream);a.removeClass("ItemSelected"),a.addClass("Item")}if(null!=t){var i=+t.replace("TTV_ItemId_",""),s=$("#"+t);i>=0&&e.length>i&&(s.removeClass("Item"),s.addClass("ItemSelected")),TwitchTV_CurrentStream=i,ShowTwitchTVVideo(!0)}else TwitchTV_CurrentStream=-1,ShowTwitchTVVideo(!1)}function GetTwitchTVStreams(){for(var t=TwitchTV_Streams,e="",a=0;t.length>a;a++){var i=t[a],s=i.channel.display_name.replace(RegExp("_","g")," "),c=i.viewers;e+=a==TwitchTV_CurrentStream?"<div class='ItemSelected' onclick='OnTwitchTVClicked(this.id)' id='TTV_ItemId_"+a+"'>":"<div class='Item' onclick='OnTwitchTVClicked(this.id)' id='TTV_ItemId_"+a+"'>",e+='<img class="Item_Image" src="'+i.preview.small+'" width="80" height="50" />',e+='<span class="Item_Body">',e+='<span class="Item_Name">'+s+"</span><br />",e+='<span class="Item_Viewers">Viewers: <b>'+c+"</b></span>",e+='<span class="Item_Link"><a href="'+i.channel.url+'" target="_blank" onclick="OnTwitchTVStopProp(event)">( ... )</a></span>',e+="</span>",e+="</div>"}return TwitchTV_HasMoreStreams&&(e+='<div class="ItemMore">',e+='<div class="ItemMore_Body" onclick="LoadTwitchTVStreamsButton()">',e+='<div class="ItemMore_ButtonLeft"></div>',e+='<div id="TTV_More" class="ItemMore_Button">',e+='<div class="ItemMore_Text">More</div>',e+="</div>",e+='<div class="ItemMore_ButtonRight"></div>',e+="</div>",e+="</div>"),e}function LoadTwitchTVStreams(){Twitch.api({method:"streams",params:{game:TwitchTV_Game,limit:TwitchTV_Limit,offset:TwitchTV_Streams.length}},function(t,e){var a="";t?a+="Stream Fetch "+t+".<br />":(e.streams.length!=TwitchTV_Limit&&(TwitchTV_HasMoreStreams=!1),TwitchTV_Streams=TwitchTV_Streams.concat(e.streams),a+=GetTwitchTVStreams(),TwitchTV_VideoActive||(ShowTwitchTVVideo(!1),TwitchTV_VideoActive=!0));var i=$("#TTV_Streams");i.html(a)})}function LoadTwitchTVStreamsButton(){$("#TTV_More").html('<span class="ItemMore_Button">...</span>'),LoadTwitchTVStreams()}function InitTwitchTV(){Twitch.init({clientId:TwitchTV_APIKey},function(t){if(t)MyText+="Twitch API "+t+".<br />";else{var e=document.getElementById("TTV_Standby");e.addEventListener("load",function(){try{var t=e.contentDocument,a=t.getElementById("TTV_Standby_Icon");a.addEventListener("click",function(){OnTwitchTVClicked(null)},!1)}catch(i){}},!1),LoadTwitchTVStreams()}})}function GetTwitchTVWidget(){var t="",e="&nbsp;&nbsp;&nbsp;&nbsp;";return t+='<div id="TTV">',t+='<div class="Widget">',t+='<div id="TTV_Video" class="Head"></div>',t+='<div id="TTV_Streams" class="Body">Loading...</div>',t+='<div class="FarEdge"></div>',t+="</div>",t+='<div class="Foot">',t+='<div class="FootBody">',t+='<span class="FootImg">',t+='<object data="'+TwitchTV_BaseDir+'ImgTwitchGlitch.svg" width="24" height="24" type="image/svg+xml" />',t+="</span>",t+="&nbsp;&nbsp;",t+='<span class="FootText">',t+='<a href="http://www.twitch.tv/directory/game/'+encodeURI(TwitchTV_Game)+'" target="_blank"> View All Streams</a>',t+="</span>",t+=e,t+='<span class="FootText">',t+='<a href="'+TwitchTV_FAQ+'">FAQ</a>',t+="</span>",t+='<span class="FootImg2">',t+='<object id="TTV_Standby" data="'+TwitchTV_BaseDir+'ImgStandby.svg" width="22" height="22" type="image/svg+xml" />',t+="</span>",t+="</div>",t+='<div class="FootEdge"></div>',t+="</div>",t+="</div>"}var TwitchTV_Limit=4,TwitchTV_CurrentStream=-1,TwitchTV_VideoActive=!1,TwitchTV_HasMoreStreams=!0,TwitchTV_Streams=[];